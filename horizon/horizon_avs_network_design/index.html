<!DOCTYPE html>
<html lang="en-us">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Horizon AVS Network Designs - Cloud 101 Site</title>
<meta name="generator" content="Hugo 0.101.0" />
<link href="https://sjainout.github.io/cloud//index.xml" rel="alternate" type="application/rss+xml">
<link rel="canonical" href="https://sjainout.github.io/cloud/horizon/horizon_avs_network_design/">
<link rel="stylesheet" href="https://sjainout.github.io/cloud/css/theme.min.css">
<link rel="stylesheet" href="https://sjainout.github.io/cloud/css/chroma.min.css">
<script defer src="https://sjainout.github.io/cloud//js/fontawesome6/all.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js" integrity="sha256-H3cjtrm/ztDeuhCN9I4yh4iN2Ybx/y1RM7rMmAesA0k=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js" integrity="sha256-4XodgW4TwIJuDtf+v6vDJ39FVxI0veC/kSCCmnFp7ck=" crossorigin="anonymous"></script>
<script src="https://sjainout.github.io/cloud/js/bundle.js"></script><style>
:root {}
</style>
<meta property="og:title" content="Horizon AVS Network Designs" />
<meta property="og:description" content="Horizon AVS Network Design Options Premise: Horizon in AVS uses hybrid architecture, where,
Horizon shared services are installed in Azure vNet Horizon desktops are installed in AVS This post covers only the following designs:
Horizon desktop access Internet via vNet Horizon desktop access Internet directly via AVS Horizon desktop access Internet via vNet AVS Network Connections:
On-prem to Azure region using WAN Express Route AVS to On-Prem using Express Route Global Reach AVS to Hub vNet via local Express Route circuit Azure Network Connections:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://sjainout.github.io/cloud/horizon/horizon_avs_network_design/" /><meta property="article:section" content="HORIZON" />
<meta property="article:published_time" content="2023-02-27T10:16:52-05:00" />
<meta property="article:modified_time" content="2023-02-27T10:16:52-05:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Horizon AVS Network Designs"/>
<meta name="twitter:description" content="Horizon AVS Network Design Options Premise: Horizon in AVS uses hybrid architecture, where,
Horizon shared services are installed in Azure vNet Horizon desktops are installed in AVS This post covers only the following designs:
Horizon desktop access Internet via vNet Horizon desktop access Internet directly via AVS Horizon desktop access Internet via vNet AVS Network Connections:
On-prem to Azure region using WAN Express Route AVS to On-Prem using Express Route Global Reach AVS to Hub vNet via local Express Route circuit Azure Network Connections:"/>
<meta itemprop="name" content="Horizon AVS Network Designs">
<meta itemprop="description" content="Horizon AVS Network Design Options Premise: Horizon in AVS uses hybrid architecture, where,
Horizon shared services are installed in Azure vNet Horizon desktops are installed in AVS This post covers only the following designs:
Horizon desktop access Internet via vNet Horizon desktop access Internet directly via AVS Horizon desktop access Internet via vNet AVS Network Connections:
On-prem to Azure region using WAN Express Route AVS to On-Prem using Express Route Global Reach AVS to Hub vNet via local Express Route circuit Azure Network Connections:"><meta itemprop="datePublished" content="2023-02-27T10:16:52-05:00" />
<meta itemprop="dateModified" content="2023-02-27T10:16:52-05:00" />
<meta itemprop="wordCount" content="593">
<meta itemprop="keywords" content="" /></head>
<body><div class="container"><header>
<h1>Cloud 101 Site</h1>
</header>
<div class="global-menu">
<nav>
<ul>
<li id="home" class=""><a href="/cloud/">&nbsp;Home</a></li>
<li id="avs doc" class=""><a href="https://docs.microsoft.com/en-us/azure/azure-vmware/">AVS Doc</a></li>
<li id="hcx doc" class=""><a href="https://docs.vmware.com/en/VMware-HCX/index.html">HCX Doc</a></li>
<li id="srm doc" class=""><a href="https://docs.vmware.com/en/VMware-Site-Recovery/index.html">SRM Doc</a></li>
<li id="horizon doc" class=""><a href="https://docs.vmware.com/en/VMware-Horizon/index.html">Horizon Doc</a></li>
<li id="about" class=""><a href="about">About</a></li></ul>
</nav>
</div>

<div class="content-container">
<main><h1>Horizon AVS Network Designs</h1>
<aside class="table_of_contents">
<h5>Table of Contents</h5><nav id="TableOfContents">
  <ul>
    <li><a href="#horizon-avs-network-design-options">Horizon AVS Network Design Options</a>
      <ul>
        <li><a href="#horizon-desktop-access-internet-via-vnet">Horizon desktop access Internet via vNet</a></li>
        <li><a href="#horizon-desktop-access-internet-directly-via-avs">Horizon desktop access Internet directly via AVS</a></li>
      </ul>
    </li>
  </ul>
</nav></aside>

<h2 id="horizon-avs-network-design-options">Horizon AVS Network Design Options</h2>
<p>Premise: Horizon in AVS uses hybrid architecture, where,</p>
<ul>
<li>Horizon shared services are installed in Azure vNet</li>
<li>Horizon desktops are installed in AVS</li>
</ul>
<p>This post covers only the following designs:</p>
<ol>
<li>Horizon desktop access Internet via vNet</li>
<li>Horizon desktop access Internet directly via AVS</li>
</ol>
<h3 id="horizon-desktop-access-internet-via-vnet">Horizon desktop access Internet via vNet</h3>
<p><img src="http://drive.google.com/uc?export=view&amp;id=12hguLLSWgzYNhy8BacJCR43MLOtJn7GZ" alt="Horizon AVS Architecture 2"></p>
<p>AVS Network Connections:</p>
<ol>
<li>On-prem to Azure region using WAN Express Route</li>
<li>AVS to On-Prem using Express Route Global Reach</li>
<li>AVS to Hub vNet via local Express Route circuit</li>
</ol>
<p>Azure Network Connections:</p>
<ol>
<li>On-Prem to Azure region using WAN Express Route terminating in Hub vNet</li>
<li>Infrastructure Shared services in spoke vNet connected to hub vNet via vNet Peering</li>
<li>Horizon Shared services in spoke vNet connected to hub vNet via vNet Peering</li>
</ol>
<p>Azure Hub vNet details:</p>
<ol>
<li>Express route gateway setup to establish connection to both AVS and on-prem</li>
<li>NVA setup for internet and network security</li>
<li>Azure Route Server setup BGP connection with NVA</li>
<li>NVA advertises 0.0.0.0/0 to Azure Route Server</li>
<li>On-prem WAN Edge router discards 0.0.0.0/0 advertisement coming from Azure region</li>
<li>vNet peering connection to Horizon shared services vNet</li>
<li>vNet peering connection to Infrastructure shared services vNet</li>
</ol>
<p>Traffic flows:</p>
<p><img src="http://drive.google.com/uc?export=view&amp;id=1jgRzs6QQZm0l7ei9nYMZw4cNtF37OTdc" alt="Horizon AVS Flows 1"></p>
<ol>
<li>On-prem end-user access &gt; WAN Express Route &gt; Hub vNet &gt; Horizon spoke vNet &gt; Horizon Connection Server</li>
<li>Internet end-user access &gt; vNet NVA &gt; vNet Peering &gt; Horizon vNet &gt; Load Balancer &gt; UAG</li>
<li>Horizon shared services &gt; vNet Peering &gt; Spoke vNet &gt; AD</li>
<li>Horizon shared services &gt; vNet Peering &gt; Hub vNet &gt; local express route circuit to AVS &gt; Horizon desktop</li>
<li>Horizon shared services &gt; vNet Peering &gt; Hub vNet &gt; NVA &gt; Internet</li>
<li>Horizon shared services &gt; vNet Peering &gt; Hub vNet &gt; WAN express route &gt; on-prem end-user</li>
<li>Horizon desktop &gt; AVS express route global reach &gt; on-prem end-user</li>
<li>Horizon desktop &gt; AVS express route to hub vNet &gt; NVA &gt; Internet based end-user</li>
<li>Horizon desktop &gt; AVS express route to hub vNet &gt; NVA &gt; Internet site</li>
</ol>
<h3 id="horizon-desktop-access-internet-directly-via-avs">Horizon desktop access Internet directly via AVS</h3>
<p><img src="http://drive.google.com/uc?export=view&amp;id=1uRBtqmggCjnw8eV3Rluef_yMKRTpgUc8" alt="Horizon AVS Architecture 2"></p>
<p>AVS Network Connections:</p>
<ol>
<li>On-prem to Azure region using WAN Express Route</li>
<li>AVS to On-Prem using Express Route Global Reach</li>
<li>AVS to Hub vNet via local Express Route circuit</li>
<li>AVS to Internet directly via NSX Edge Public IP</li>
</ol>
<p>Azure Network Connections:</p>
<ol>
<li>On-Prem to Azure region using WAN Express Route terminating in Hub vNet</li>
<li>Infrastructure Shared services in spoke vNet connected to hub vNet via vNet Peering</li>
<li>Horizon Shared services in spoke vNet connected to hub vNet via vNet Peering</li>
</ol>
<p>Azure Hub vNet details:</p>
<ol>
<li>Express route gateway setup to establish connection to both AVS and on-prem</li>
<li>NVA setup for internet and network security for Azure native VMs and services</li>
<li>No BGP configuration, just UDRs for traffic re-direction</li>
<li>vNet peering connection to Horizon shared services vNet</li>
<li>vNet peering connection to Infrastructure shared services vNet</li>
</ol>
<p>Traffic flows:</p>
<p><img src="http://drive.google.com/uc?export=view&amp;id=1Qx4G9YS901cePFJ6lTMakbguNscLYcEL" alt="Horizon AVS Flows 2"></p>
<ol>
<li>On-prem end-user access &gt; WAN Express Route &gt; Hub vNet &gt; Horizon spoke vNet &gt; Horizon Connection Server</li>
<li>Internet end-user access &gt; vNet NVA &gt; vNet Peering &gt; Horizon vNet &gt; Load Balancer &gt; UAG</li>
<li>Horizon shared services &gt; vNet Peering &gt; Spoke vNet &gt; AD</li>
<li>Horizon shared services &gt; vNet Peering &gt; Hub vNet &gt; local express route circuit to AVS &gt; Horizon desktop</li>
<li>Horizon shared services &gt; vNet Peering &gt; Hub vNet &gt; NVA &gt; Internet</li>
<li>Horizon shared services &gt; vNet Peering &gt; Hub vNet &gt; WAN express route &gt; on-prem end-user</li>
<li>Horizon desktop &gt; AVS express route global reach &gt; on-prem end-user</li>
<li>Horizon desktop &gt; AVS express route to hub vNet &gt; NVA &gt; Internet based end-user</li>
<li>Horizon desktop &gt; AVS NVA &gt; PIP &gt; Internet site</li>
</ol>
<div class="edit-meta">
Last updated on 27 Feb 2023


<br>
Published on 27 Feb 2023
<br></div><nav class="pagination"><a class="nav nav-prev" href="https://sjainout.github.io/cloud/horizon/" title="Horizon Virtual Desktop in AVS"><i class="fas fa-arrow-left" aria-hidden="true"></i>&nbsp;Prev - Horizon Virtual Desktop in AVS</a>
<a class="nav nav-next" href="https://sjainout.github.io/cloud/avs/" title="Azure VMware Solution">Next - Azure VMware Solution <i class="fas fa-arrow-right" aria-hidden="true"></i></a>
</nav><footer><p class="powered">Powered by <a href="https://gohugo.io">Hugo</a>. Theme by <a href="https://themes.gohugo.io/hugo-theme-techdoc/">TechDoc</a>. Designed by <a href="https://github.com/thingsym/hugo-theme-techdoc">Thingsym</a>.</p>
</footer>
</main>
<div class="sidebar">

<nav class="open-menu">
<ul>
<li class=""><a href="https://sjainout.github.io/cloud/">Home</a></li>

<li class=""><a href="https://sjainout.github.io/cloud/avs/">Azure VMware Solution</a>
  
<ul class="sub-menu">
<li class=""><a href="https://sjainout.github.io/cloud/avs/avs_internet_access/">AVS Internet Access Architecture Options</a></li>
<li class=""><a href="https://sjainout.github.io/cloud/avs/avs_nsxt_nva_architectures/">AVS NSXT NVA Architectures</a></li>
<li class=""><a href="https://sjainout.github.io/cloud/avs/avs_reservation/">AVS Reservation</a></li>
</ul>
  
</li>

<li class=""><a href="https://sjainout.github.io/cloud/hcx/">Migration</a>
  
<ul class="sub-menu">
<li class=""><a href="https://sjainout.github.io/cloud/hcx/hcx_avs_install/">HCX AVS Install</a></li>
<li class=""><a href="https://sjainout.github.io/cloud/hcx/hcx_on_prem_download/">HCX On-Prem Connector OVA Download</a></li>
<li class=""><a href="https://sjainout.github.io/cloud/hcx/hcx_network_migrate/">Migrate Network with HCX</a></li>
<li class=""><a href="https://sjainout.github.io/cloud/hcx/hcx_vm_network_migrate_demo/">Migrate VM and Network - Lab Demo</a></li>
</ul>
  
</li>

<li class=""><a href="https://sjainout.github.io/cloud/srm/">Disaster Recovery</a>
  
<ul class="sub-menu">
<li class=""><a href="https://sjainout.github.io/cloud/srm/srm_avs_install/">SRM AVS Install</a></li>
<li class=""><a href="https://sjainout.github.io/cloud/srm/srm_hcx_same_ip_architecture/">Application-DR Architecture</a></li>
<li class=""><a href="https://sjainout.github.io/cloud/srm/srm_dr_backup_architecture/">HA, DR, plus Backup Architecture</a></li>
<li class=""><a href="https://sjainout.github.io/cloud/srm/srm_dr_functions_demo/">Application DR Functional Demo</a></li>
</ul>
  
</li>

<li class="parent"><a href="https://sjainout.github.io/cloud/horizon/">Horizon Virtual Desktop in AVS</a>
  
<ul class="sub-menu">
<li class="active"><a href="https://sjainout.github.io/cloud/horizon/horizon_avs_network_design/">Horizon AVS Network Designs</a></li>
</ul>
  
</li>
</ul>
</nav>



<div class="sidebar-footer"></div>
</div>

</div><a href="#" id="backtothetop-fixed" class="backtothetop"
 data-backtothetop-duration="600"
 data-backtothetop-easing="easeOutQuart"
 data-backtothetop-fixed-fadeIn="1000"
 data-backtothetop-fixed-fadeOut="1000"
 data-backtothetop-fixed-bottom="10"
 data-backtothetop-fixed-right="20">
<span class="fa-layers fa-fw">
<i class="fas fa-circle"></i>
<i class="fas fa-arrow-circle-up"></i>
</span></a>
</div>
</body>
</html>
